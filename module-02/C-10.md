## Proxy

ржирзЗржХрзНрж╕ржЯ ржЬрзЗржПрж╕ (Next.js) ржмрж╛ ржУрзЯрзЗржм ржбрзЗржнрзЗрж▓ржкржорзЗржирзНржЯрзЗрж░ ржкрзНрж░рзЗржХрзНрж╖рж╛ржкржЯрзЗ **Proxy** рж╣рж▓рзЛ ржПржХржЯрж┐ ржоржзрзНржпрж╕рзНржерждрж╛ржХрж╛рж░рзА (Middleman) рж╕рж╛рж░рзНржнрж╛рж░, ржпрж╛ ржХрзНрж▓рж╛рзЯрзЗржирзНржЯ (ржмрзНрж░рж╛ржЙржЬрж╛рж░) ржПржмржВ ржорзЗржЗржи рж╕рж╛рж░рзНржнрж╛рж░рзЗрж░ (API) ржорж╛ржЭржЦрж╛ржирзЗ ржерж╛ржХрзЗред ржПржЯрж┐ ржорзВрж▓ржд рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржЖржжрж╛ржи-ржкрзНрж░ржжрж╛ржи ржХрж░рж╛рж░ рж╕ржорзЯ рж╕рж┐ржХрж┐ржЙрж░рж┐ржЯрж┐ ржмрж╛ ржбрзЗржЯрж╛ ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯрзЗрж░ ржХрж╛ржЬ ржХрж░рзЗред

ржирж┐ржЪрзЗ ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд ржЖрж▓рзЛржЪржирж╛ ржХрж░рж╛ рж╣рж▓рзЛ:

---

### рзз. Proxy ржХрзЗржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи? (The "Why")

ржУрзЯрзЗржм ржбрзЗржнрзЗрж▓ржкржорзЗржирзНржЯрзЗ ржкрзНрж░ржХрзНрж╕рж┐ ржмрзНржпржмрж╣рж╛рж░рзЗрж░ рзйржЯрж┐ ржкрзНрж░ржзрж╛ржи ржХрж╛рж░ржг рж░рзЯрзЗржЫрзЗ:

- **CORS рж╕ржорж╕рзНржпрж╛ рж╕ржорж╛ржзрж╛ржи:** ржмрзНрж░рж╛ржЙржЬрж╛рж░ рж╕рж╛ржзрж╛рж░ржгржд ржПржХ ржбрзЛржорзЗржЗржи ржерзЗржХрзЗ ржЕржирзНржп ржбрзЛржорзЗржЗржирзЗ (ржпрзЗржоржи: `localhost:3000` ржерзЗржХрзЗ `api.othersite.com`) рж╕рж░рж╛рж╕рж░рж┐ ржбрзЗржЯрж╛ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржкрж╛ржарж╛рждрзЗ ржмрж╛ржзрж╛ ржжрзЗрзЯред ржкрзНрж░ржХрзНрж╕рж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржмрзНрж░рж╛ржЙржЬрж╛рж░ ржоржирзЗ ржХрж░рзЗ рж╕рзЗ ржирж┐ржЬрзЗрж░ рж╕рж╛рж░рзНржнрж╛рж░рзЗржЗ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржкрж╛ржарж╛ржЪрзНржЫрзЗред
- **Security (IP Masking):** ржЖржкржирж╛рж░ ржЕрж░рж┐ржЬрж┐ржирж╛рж▓ ржмрзНржпрж╛ржХржПржирзНржб рж╕рж╛рж░рзНржнрж╛рж░рзЗрж░ IP ржмрж╛ URL рж╣рж╛ржЗржб ржХрж░рзЗ рж░рж╛ржЦрж╛ ржпрж╛рзЯред ржХрзНрж▓рж╛рзЯрзЗржирзНржЯ рж╢рзБржзрзБ ржкрзНрж░ржХрзНрж╕рж┐рж░ ржарж┐ржХрж╛ржирж╛ ржЬрж╛ржиржмрзЗред
- **API URL рж╕рж╣ржЬ ржХрж░рж╛:** ржмрзЬ ржХрзЛржирзЛ ржПржкрж┐ржЖржЗ ржЗржЙржЖрж░ржПрж▓ (ржпрзЗржоржи: `https://very-long-api-name.com/v1/api/data`) ржХрзЗ ржХржорж┐рзЯрзЗ `/api/data` рждрзЗ рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рж╛ ржпрж╛рзЯред

---

### рзи. ржХрж┐ржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ? (The Mechanism)

рзз. ржмрзНрж░рж╛ржЙржЬрж╛рж░ рж╕рж░рж╛рж╕рж░рж┐ API-рждрзЗ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржирж╛ ржкрж╛ржарж┐рзЯрзЗ ржЖржкржирж╛рж░ ржирж┐ржЬрзЗрж░ рж╕рж╛рж░рзНржнрж╛рж░ржХрзЗ (Next.js) рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржкрж╛ржарж╛рзЯред
рзи. ржЖржкржирж╛рж░ ржирзЗржХрзНрж╕ржЯ ржЬрзЗржПрж╕ рж╕рж╛рж░рзНржнрж╛рж░ рж╕рзЗржЗ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯржЯрж┐ ржзрж░рзЗ ржмрзНржпрж╛ржХржПржирзНржб ржПржкрж┐ржЖржЗ-рждрзЗ ржкрж╛ржарж┐рзЯрзЗ ржжрзЗрзЯред
рзй. ржмрзНржпрж╛ржХржПржирзНржб ржерзЗржХрзЗ ржбрзЗржЯрж╛ ржЖрж╕рж╛рж░ ржкрж░ ржирзЗржХрзНрж╕ржЯ ржЬрзЗржПрж╕ рж╕рзЗржЯрж┐ ржмрзНрж░рж╛ржЙржЬрж╛рж░ржХрзЗ ржлрж┐рж░рж┐рзЯрзЗ ржжрзЗрзЯред

---

### рзй. Next.js-ржП Proxy ржХрж┐ржнрж╛ржмрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи? (The "How")

Next.js-ржП ржкрзНрж░ржХрзНрж╕рж┐ рж╕рзЗржЯржЖржк ржХрж░рж╛рж░ ржжрзБржЯрж┐ ржЬржиржкрзНрж░рж┐рзЯ ржЙржкрж╛рзЯ ржЖржЫрзЗ:

#### ржкржжрзНржзрждрж┐ ржХ: `next.config.js` ржП Rewrites ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ (рж╕ржмржЪрзЗржпрж╝рзЗ рж╕рж╣ржЬ)

ржПрж░ ржорж╛ржзрзНржпржорзЗ ржЖржкржирж┐ ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗрж░ URL ржкрж░рж┐ржмрж░рзНрждржи ржирж╛ ржХрж░рзЗржЗ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯржХрзЗ ржЕржирзНржп рж╕рж╛рж░рзНржнрж╛рж░рзЗ ржбрж╛ржЗрж░рзЗржХрзНржЯ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред

```javascript
// next.config.mjs
/** @type {import('next').NextConfig} */
const nextConfig = {
  async rewrites() {
    return [
      {
        source: "/api/:path*", // ржпржЦржи ржХрзЗржЙ /api/users ржП рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржХрж░ржмрзЗ
        destination: "https://backend-api.com/:path*", // рждржЦржи рж╕рзЗржЯрж┐ ржПржЗ ржЗржЙржЖрж░ржПрж▓-ржП ржЪрж▓рзЗ ржпрж╛ржмрзЗ
      },
    ];
  },
};

export default nextConfig;
```

#### ржкржжрзНржзрждрж┐ ржЦ: API Routes ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ (Custom Logic)

ржпржЦржи ржЖржкржирж╛рж░ ржкрзНрж░ржХрзНрж╕рж┐рж░ рж╕рж╛ржерзЗ ржХрзЛржирзЛ рж╣рзЗржбрж╛рж░ (Header) ржмрж╛ ржЯрзЛржХрзЗржи ржпрзЛржЧ ржХрж░рж╛рж░ ржкрзНрж░рзЯрзЛржЬржи рж╣рзЯред

```typescript
// app/api/proxy/route.ts
export async function GET() {
  const res = await fetch("https://external-api.com/data", {
    headers: {
      Authorization: `Bearer ${process.env.API_KEY}`, // ржХрзНрж▓рж╛рзЯрзЗржирзНржЯ ржПржЗ ржХрж┐ (Key) ржжрзЗржЦрждрзЗ ржкрж╛ржмрзЗ ржирж╛
    },
  });
  const data = await res.json();
  return Response.json(data);
}
```

---

### рзк. ржмрж╛рж╕рзНрждржм ржЙржжрж╛рж╣рж░ржг (Real-world Scenario)

ржзрж░рзБржи ржЖржкржирж╛рж░ ржлрзНрж░ржирзНржЯржПржирзНржб ржЪрж▓рзЗ `mysite.com` ржП ржПржмржВ ржмрзНржпрж╛ржХржПржирзНржб ржЪрж▓рзЗ `backend.com` ржПред
ржмрзНрж░рж╛ржЙржЬрж╛рж░ ржерзЗржХрзЗ рж╕рж░рж╛рж╕рж░рж┐ `backend.com` ржП рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржкрж╛ржарж╛рж▓рзЗ **CORS Error** ржЖрж╕рждрзЗ ржкрж╛рж░рзЗред

ржЖржкржирж┐ ржпржжрж┐ ржкрзНрж░ржХрзНрж╕рж┐ рж╕рзЗржЯржЖржк ржХрж░рзЗржи, рждржмрзЗ ржмрзНрж░рж╛ржЙржЬрж╛рж░ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржкрж╛ржарж╛ржмрзЗ `mysite.com/api/login` ржПред ржирзЗржХрзНрж╕ржЯ ржЬрзЗржПрж╕ рж╕рж╛рж░рзНржнрж╛рж░ ржЗржирзНржЯрж╛рж░ржирж╛рж▓рж┐ рж╕рзЗржЗ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯржЯрж┐ `backend.com/login` ржП ржкрж╛ржарж┐рзЯрзЗ ржжрж┐ржмрзЗред ржмрзНрж░рж╛ржЙржЬрж╛рж░ ржЬрж╛ржиржмрзЗржУ ржирж╛ ржпрзЗ ржбрзЗржЯрж╛ ржЕржирзНржп ржХрзЛржирзЛ ржбрзЛржорзЗржЗржи ржерзЗржХрзЗ ржЖрж╕ржЫрзЗред

---

### рзл. ржоржирзЗ рж░рж╛ржЦрж╛рж░ ржорждрзЛ ржкрзЯрзЗржирзНржЯ ЁЯУЭ

| ржмрзИрж╢рж┐рж╖рзНржЯрзНржп       | ржмрж┐ржмрж░ржг                                                                       |
| --------------- | --------------------------------------------------------------------------- |
| **CORS Bypass** | ржкрзНрж░ржХрзНрж╕рж┐ ржмрзНржпржмрж╣рж╛рж░рзЗрж░ рж╕ржмржЪрзЗрзЯрзЗ ржмрзЬ рж╕рзБржмрж┐ржзрж╛ред                                         |
| **Performance** | ржЕрждрж┐рж░рж┐ржХрзНржд ржПржХржЯрж┐ рж╕рж╛рж░рзНржнрж╛рж░ рж▓рзЗржпрж╝рж╛рж░ рж╣ржУрзЯрж╛рж░ ржХрж╛рж░ржгрзЗ ржЦрзБржм рж╕рж╛ржорж╛ржирзНржп ржбрж┐рж▓рзЗ (Delay) рж╣рждрзЗ ржкрж╛рж░рзЗред |
| **Security**    | рж╕рзЗржирж╕рж┐ржЯрж┐ржн API Key ржмрж╛ ржЯрзЛржХрзЗржи рж▓рзБржХрж╛ржирзЛрж░ ржЬржирзНржп рж╕рзЗрж░рж╛ ржЙржкрж╛рзЯред                           |
