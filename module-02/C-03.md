## ЁЯФ┤ Next.js App Router: error.js ржПрж░ ржкрзВрж░рзНржгрж╛ржЩрзНржЧ ржЧрж╛ржЗржб

Next.js-ржП ржЕрзНржпрж╛ржк ржЪрж╛рж▓рж╛ржирзЛрж░ рж╕ржорзЯ ржХрзЛржирзЛ ржнрзБрж▓ ржмрж╛ ржПрж░рж░ (Error) рж╣рж▓рзЗ ржкрзБрж░рзЛ ржУрзЯрзЗржмрж╕рж╛ржЗржЯ ржпрзЗржи ржХрзНрж░рзНржпрж╛рж╢ ржирж╛ ржХрж░рзЗ, ржмрж░ржВ ржЗржЙржЬрж╛рж░ржХрзЗ ржПржХржЯрж┐ рж╕рзБржирзНржжрж░ ржорзЗрж╕рзЗржЬ ржПржмржВ рж░рж┐ржХржнрж╛рж░рж┐ ржЕржкрж╢ржи ржжрзЗржЦрж╛ржирзЛ ржпрж╛рзЯ, рж╕рзЗржЬржирзНржпржЗ **`error.js`** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯред ржПржЯрж┐ ржорзВрж▓ржд **React Error Boundary** рж╣рж┐рж╕рзЗржмрзЗ ржХрж╛ржЬ ржХрж░рзЗред

### ЁЯФ╣ рзз. error.js ржХрзА?

ржПржЯрж┐ рж╣ржЪрзНржЫрзЗ ржПржХржЯрж┐ **Route-level error UI**ред ржпржЦржи ржХрзЛржирзЛ рж░рж╛ржЙржЯрзЗрж░ ржнрзЗрждрж░рзЗ (рж╕рж╛рж░рзНржнрж╛рж░ ржмрж╛ ржХрзНрж▓рж╛рзЯрзЗржирзНржЯ рж╕рж╛ржЗржбрзЗ) ржХрзЛржирзЛ ржПрж░рж░ ржШржЯрзЗ, рждржЦржи Next.js ржЕржЯрзЛржорзЗржЯрж┐ржХ рж╕рзЗржЗ ржкрзЗржЬржЯрж┐ржХрзЗ рж░рж┐ржкрзНрж▓рзЗрж╕ ржХрж░рзЗ ржПржЗ ржлрж╛ржЗрж▓рзЗрж░ ржХржирзНржЯрзЗржирзНржЯ ржжрзЗржЦрж╛рзЯред

**ЁЯУБ ржлрзЛрж▓рзНржбрж╛рж░ рж╕рзНржЯрзНрж░рж╛ржХржЪрж╛рж░:**

```text
app/
 тФФтФА dashboard/
     тФЬтФА page.tsx
     тФФтФА error.tsx   (ржЕржЯрзЛржорзЗржЯрж┐ржХ ржПрж░рж░ ржмрж╛ржЙржирзНржбрж╛рж░рж┐)

```

---

### тЪЩя╕П рзи. ржХржЦржи error.js ржЯрзНрж░рж┐ржЧрж╛рж░ рж╣ржпрж╝?

ржирж┐ржЪрзЗрж░ ржпрзЗржХрзЛржирзЛ ржПржХржЯрж┐ ржХрж╛рж░ржгрзЗ ржПржЯрж┐ ржЯрзНрж░рж┐ржЧрж╛рж░ рж╣рждрзЗ ржкрж╛рж░рзЗ:

1. **Server Component ржП ржПрж░рж░:** ржбрж╛ржЯрж╛ ржлрзЗржЪрж┐ржВ ржмрж╛ рж▓ржЬрж┐ржХ ржкрзНрж░рзЛрж╕рзЗрж╕ ржХрж░рж╛рж░ рж╕ржорзЯ рж╕рж╛рж░рзНржнрж╛рж░рзЗ ржХрзЛржирзЛ ржПрж░рж░ рж╣рж▓рзЗред
2. **Client Component ржП рж░рж╛ржиржЯрж╛ржЗржо ржПрж░рж░:** ржЗржЙржЬрж╛рж░рзЗрж░ ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗ ржХрзЛржб ржЪрж▓рж╛рж░ рж╕ржорзЯ ржХрзЛржирзЛ ржнрзБрж▓ рж╣рж▓рзЗред
3. **Explicit Error:** ржЖржкржирж┐ ржирж┐ржЬрзЗ ржпржжрж┐ ржХрзЛржбрзЗ `throw new Error()` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗржиред

---

### ЁЯФе рзй. ржХрзЗржи error.js ржЕржмрж╢рзНржпржЗ "use client" рж╣рждрзЗ рж╣ржмрзЗ?

ржПрж░ ржХрж╛рж░ржг ржжрзБржЯрж┐:

1. **Error Boundary** ржПржХржЯрж┐ рж░рж┐рзЯрзНржпрж╛ржХрзНржЯ ржХрзНрж▓рж╛рзЯрзЗржирзНржЯ-рж╕рж╛ржЗржб ржлрж┐ржЪрж╛рж░ред
2. ржПржЦрж╛ржирзЗ **Retry/Reset** ржмрж╛ржЯржирзЗрж░ ржорждрзЛ ржЗржЙржЬрж╛рж░ ржЗржирзНржЯрж╛рж░ржЕрзНржпрж╛ржХрж╢ржи ржерж╛ржХрзЗ, ржпрж╛ рж╢рзБржзрзБ ржХрзНрж▓рж╛рзЯрзЗржирзНржЯ рж╕рж╛ржЗржбрзЗржЗ рж╕ржорзНржнржмред
   ЁЯСЙ ржпржжрж┐ ржЖржкржирж┐ `"use client"` ржирж╛ ржжрзЗржи, рждржмрзЗ Next.js ржПржХржЯрж┐ ржПрж░рж░ ржжрзЗржЦрж╛ржмрзЗред

---

### ЁЯзк рзк. ржмрж╛рж╕рзНрждржм ржЙржжрж╛рж╣рж░ржг (Example)

**`page.tsx`**

```tsx
export default function Page() {
  // ржзрж░рзБржи ржХрзЛржирзЛ ржХрж╛рж░ржгрзЗ ржПржХржЯрж┐ ржПрж░рж░ ржШржЯрж▓рзЛ
  throw new Error("Data fetching failed from server!");

  return <h1>Dashboard Page</h1>;
}
```

**`error.tsx`**

```tsx
"use client"; // ржЕржмрж╢рзНржпржЗ ржерж╛ржХрждрзЗ рж╣ржмрзЗ

import { useEffect } from "react";

export default function Error({
  error,
  reset,
}: {
  error: Error & { digest?: string };
  reset: () => void;
}) {
  useEffect(() => {
    // ржЖржкржирж┐ ржЪрж╛ржЗрж▓рзЗ ржПржЦрж╛ржирзЗ ржПрж░рж░ржЯрж┐ ржХрзЛржирзЛ рж╕рж╛рж░рзНржнрж┐рж╕рзЗ рж▓ржЧ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи (ржпрзЗржоржи: Sentry)
    console.error(error);
  }, [error]);

  return (
    <div className="p-10 text-center">
      <h2 className="text-red-500 font-bold">ржХрж┐ржЫрзБ ржПржХржЯрж╛ рж╕ржорж╕рзНржпрж╛ рж╣рзЯрзЗржЫрзЗ!</h2>
      <p className="mb-4">{error.message}</p>

      {/* reset() ржлрж╛ржВрж╢ржиржЯрж┐ рж░рж╛ржЙржЯржЯрж┐ржХрзЗ ржЖржмрж╛рж░ рж░рзЗржирзНржбрж╛рж░ ржХрж░рж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░ржмрзЗ */}
      <button
        onClick={() => reset()}
        className="bg-blue-500 text-white px-4 py-2 rounded"
      >
        Retry (ржЖржмрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржи)
      </button>
    </div>
  );
}
```

---

### тЩ╗я╕П рзл. reset() ржХрзА ржХрж░рзЗ?

`reset()` ржлрж╛ржВрж╢ржиржЯрж┐ Next.js-ржПрж░ ржПржХржЯрж┐ рж╕рзНржкрзЗрж╢рж╛рж▓ ржлрж╛ржВрж╢ржиред ржПржЯрж┐ ржпржЦржи ржХрж▓ ржХрж░рж╛ рж╣рзЯ:

- ржПржЯрж┐ ржУржЗ рж░рж╛ржЙржЯ ржмрж╛ ржкрзЗржЬржЯрж┐ржХрзЗ ржЖржмрж╛рж░ **Re-render** ржХрж░рж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзЗред
- ржпржжрж┐ рж╕ржорж╕рзНржпрж╛ржЯрж┐ рж╕рж╛ржорзЯрж┐ржХ (ржпрзЗржоржи: рж╣рж╛рж▓ржХрж╛ ржирзЗржЯржУрзЯрж╛рж░рзНржХ ржПрж░рж░) рж╣рзЯ, рждржмрзЗ ржжрзНржмрж┐рждрзАрзЯржмрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛рзЯ ржкрзЗржЬржЯрж┐ ржарж┐ржХ рж╣рзЯрзЗ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред

---

### ЁЯУж рзм. ржирзЗрж╕рзНржЯрзЗржб рж░рзБржЯ ржмрж┐рж╣рзЗржнрж┐ржпрж╝рж╛рж░ (Nested Behavior)

- **Parent vs Child:** ржпржжрж┐ `dashboard/` ржП ржПржХржЯрж┐ `error.js` ржерж╛ржХрзЗ ржПржмржВ рждрж╛рж░ ржЪрж╛ржЗрж▓рзНржб `settings/` ржП ржХрзЛржирзЛ ржПрж░рж░ рж╣рзЯ, рждржмрзЗ ржбрзНржпрж╛рж╢ржмрзЛрж░рзНржбрзЗрж░ ржПрж░рж░ ржлрж╛ржЗрж▓ржЯрж┐ржЗ рж╕рзЗржЯрж┐ рж╣рзНржпрж╛ржирзНржбрзЗрж▓ ржХрж░ржмрзЗред
- **Override:** ржХрж┐ржирзНрждрзБ ржпржжрж┐ `settings/` ржлрзЛрж▓рзНржбрж╛рж░рзЗржУ ржПржХржЯрж┐ ржирж┐ржЬрж╕рзНржм `error.js` ржерж╛ржХрзЗ, рждржмрзЗ рж╕рзЗржЯрж┐ржЗ ржкрзНрж░рж╛ржзрж╛ржирзНржп ржкрж╛ржмрзЗред
- **Global Error:** ржкрзБрж░рзЛ ржЕрзНржпрж╛ржкрзЗрж░ рж╕ржмржХрж┐ржЫрзБрж░ ржЬржирзНржп `app/error.js` рж░рж╛ржЦрж╛ ржПржХржЯрж┐ ржмрзЗрж╕рзНржЯ ржкрзНрж░рзНржпрж╛ржХржЯрж┐рж╕ред

---

### ЁЯЪл рзн. ржХржоржи ржнрзБрж▓ (Common Mistakes)

1. **Layout Error:** ржоржирзЗ рж░рж╛ржЦржмрзЗржи, ржПржХржЯрж┐ рж░рж╛ржЙржЯрзЗрж░ `error.js` ржУржЗ рж░рж╛ржЙржЯрзЗрж░ **Layout.js**-ржПрж░ ржПрж░рж░ ржзрж░рждрзЗ ржкрж╛рж░рзЗ ржирж╛ (ржХрж╛рж░ржг ржПржЯрж┐ рж▓рзЗржЖржЙржЯрзЗрж░ ржнрзЗрждрж░рзЗ ржерж╛ржХрзЗ)ред рж▓рзЗржЖржЙржЯрзЗрж░ ржПрж░рж░ ржзрж░рждрзЗ рж╣рж▓рзЗ рждрж╛рж░ ржЙржкрж░рзЗрж░ рж▓рзЗржнрзЗрж▓рзЗрж░ ржПрж░рж░ ржлрж╛ржЗрж▓ ржжрж░ржХрж╛рж░ред
2. **Data Fetching:** ржПрж░рж░ ржлрж╛ржЗрж▓рзЗрж░ ржнрзЗрждрж░рзЗ ржЬржЯрж┐рж▓ ржХрзЛржирзЛ ржЕрзНржпрж╛ржкрж┐ ржХрж▓ ржмрж╛ ржбрж╛ржЯрж╛ ржлрзЗржЪ ржХрж░ржмрзЗржи ржирж╛ред
3. **User-friendly:** ржЯрзЗржХржирж┐ржХрзНржпрж╛рж▓ ржПрж░рж░ ржХрзЛржб (ржпрзЗржоржи: 500 internal error) рж╕рж░рж╛рж╕рж░рж┐ ржЗржЙржЬрж╛рж░ржХрзЗ ржирж╛ ржжрзЗржЦрж┐рзЯрзЗ рж╕рзБржирзНржжрж░ ржорзЗрж╕рзЗржЬ ржжрж┐ржиред

---

### ЁЯФС ржПржХ рж▓рж╛ржЗржирзЗ рж╕рж╛рж░рж╛ржВрж╢

`error.js` рж╣рж▓рзЛ ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржкрзЗрж░ ржПржХржЯрж┐ **Safety Net**, ржпрж╛ ржХрзЛржирзЛ ржнрзБрж▓ рж╣рж▓рзЗ ржкрзБрж░рзЛ ржУрзЯрзЗржмрж╕рж╛ржЗржЯ ржмржирзНржз рж╣рждрзЗ ржжрзЗрзЯ ржирж╛ ржПржмржВ ржЗржЙржЬрж╛рж░ржХрзЗ рж░рж┐ржЯрзНрж░рж╛ржЗ (Retry) ржХрж░рж╛рж░ рж╕рзБржпрзЛржЧ ржжрзЗрзЯред
